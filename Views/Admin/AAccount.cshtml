@{
    ViewData["Title"] = "Admin Account";
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewData["NavSection"] = "Admin";
}

<!-- Scoped styles for AAccount only -->
<style>
    .aacc, .aacc .card {
        color: var(--text-color) !important;
    }

        .aacc .caption, .aacc .text-muted {
            color: var(--muted-text-color) !important;
        }

        .aacc .form-control, .aacc .form-select, .aacc input[type="password"] {
            background-color: var(--surface-color) !important;
            color: var(--text-color) !important;
            border: 1px solid var(--border-color) !important;
            border-radius: 8px !important;
            padding: 10px 12px !important;
            width: 100%;
        }

            .aacc .form-control::placeholder {
                color: var(--muted-text-color) !important;
            }

            .aacc .form-control:focus, .aacc .form-select:focus {
                outline: none !important;
                border-color: var(--primary-color) !important;
                box-shadow: 0 0 0 0.15rem var(--accent-color) !important;
            }

        .aacc .section-title {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
        }
</style>

<div class="aacc">
    <!-- Header -->
    <div class="d-flex justify-content-between align-items-center mb-16">
        <h1 class="mb-0">Admin Account</h1>
        <a asp-controller="Admin" asp-action="ADashboard" class="btn btn-secondary">← Back to Dashboard</a>
    </div>

    <!-- Top: Info -->
    <div class="card shadow p-24 mb-16">
        <div class="d-flex flex-column flex-md-row align-items-start align-items-md-center justify-content-between">
            <div>
                <h3 class="mb-8">Account Overview</h3>
                <div class="caption">
                    This is the single admin account. From here you can change the password and set your preferred theme.
                    (Theme preference is saved in this browser for demo purposes.)
                </div>
            </div>
        </div>
    </div>

    <!-- Main row -->
    <div class="row g-3">
        <!-- Change Password -->
        <div class="col-lg-6">
            <div class="card shadow p-24 h-100">
                <div class="section-title mb-8">
                    <h3 class="mb-0">Change Password</h3>
                </div>

                <!-- ===== DEMO STUB (no backend) — replace wiring later ===== -->
                <form asp-controller="Admin" asp-action="ChangePassword" method="post">
                    <div class="mb-16">
                        <label for="CurrentPassword" class="form-label">Current Password</label>
                        <input name="CurrentPassword" id="CurrentPassword" type="password" class="form-control" placeholder="Enter current password" />
                    </div>
                    <div class="row">
                        <div class="col-md-6 mb-16">
                            <label for="NewPassword" class="form-label">New Password</label>
                            <input name="NewPassword" id="NewPassword" type="password" class="form-control" placeholder="Enter new password" />
                        </div>
                        <div class="col-md-6 mb-16">
                            <label for="ConfirmPassword" class="form-label">Confirm New Password</label>
                            <input name="ConfirmPassword" id="ConfirmPassword" type="password" class="form-control" placeholder="Re-enter new password" />
                        </div>
                    </div>
                    <div class="caption mb-12">
                        Password must be at least 8 characters. (UI only — no validation or submit yet.)
                    </div>

                    <div class="d-flex gap-2">
                        <button type="submit" class="btn btn-primary">Change Password</button>
                        <button class="btn btn-outline-secondary" disabled>Cancel</button>
                    </div>
                </form>
                <!-- ===== /DEMO STUB ======================================= -->
            </div>
        </div>

        <!-- Theme Preference -->
        <div class="col-lg-6" >
            <form class="card shadow p-24 h-100" asp-controller="Admin" asp-action="SetTheme" method="post">
                <div class="section-title mb-8">
                    <h3 class="mb-0">Theme Preference</h3>
                </div>

                <div class="mb-16">
                    <label class="form-label">Select Theme</label>
                    <div class="d-flex gap-4 align-items-center">
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="adminTheme" id="Light" value="Light">
                            <label class="form-check-label" for="themeLight">Light</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="adminTheme" id="Dark" value="Dark">
                            <label class="form-check-label" for="themeDark">Dark</label>
                        </div>
                    </div>
                    <div class="caption mt-8">
                        Applies immediately and persists in your browser (local storage). This is UI-only for the demo.
                    </div>
                </div>

                <div class="d-flex gap-2">
                    <button id="applyTheme" class="btn btn-outline-primary" type="submit">Apply Theme</button>
                </div>
            </form>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        (function () {
            // === Demo theme persistence for admin ===
            const THEME_KEY = 'jt_theme';
            const body = document.body;
            const radioLight = document.getElementById('themeLight');
            const radioDark = document.getElementById('themeDark');
            const btnApply = document.getElementById('applyTheme');
            const btnReset = document.getElementById('resetTheme');

            function setTheme(theme) {
                // Remove any previous theme class, then add selected.
                body.classList.remove('light-theme', 'dark-theme');
                body.classList.add(theme === 'dark' ? 'dark-theme' : 'light-theme');
            }

            function loadTheme() {
                const saved = localStorage.getItem(THEME_KEY) || 'light';
                setTheme(saved);
                if (saved === 'dark') {
                    radioDark.checked = true;
                } else {
                    radioLight.checked = true;
                }
            }

            function applySelectedTheme() {
                const selected = radioDark.checked ? 'dark' : 'light';
                localStorage.setItem(THEME_KEY, selected);
                setTheme(selected);
            }

            function resetTheme() {
                localStorage.setItem(THEME_KEY, 'light');
                radioLight.checked = true;
                setTheme('light');
            }

            // Init
            loadTheme();
            btnApply.addEventListener('click', applySelectedTheme);
            btnReset.addEventListener('click', resetTheme);
        })();
    </script>
}

@* --------------------------------------------------------------------
   TODO: Wire Up AAccount
   - Implement secure password change (POST to Admin/ChangePassword):
       • Validate current password
       • Validate new password & confirmation
       • Hash & update
       • Show success/error alerts
   - Persist theme preference server-side per admin (optional),
     and hydrate on page load (fallback to localStorage is fine for demo).
   - Auth guard: admin-only access.
--------------------------------------------------------------------- *@
