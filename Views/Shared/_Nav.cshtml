@{
    // Which menu to show? "Public", "User", or "Admin". Default to Public.
    var navSection = (ViewData["NavSection"] as string ?? "Public").ToLowerInvariant();

    // Current action name for active highlighting
    var actionName = (ViewContext.RouteData.Values["action"]?.ToString() ?? "").ToLowerInvariant();

    string Active(string action) => actionName == action.ToLowerInvariant() ? "active" : "";
}

<nav class="navbar navbar-expand-sm app-navbar mb-3">
    <div class="container-fluid">
        <!-- Brand route by section -->
        @if (navSection == "user")
        {
            <a class="navbar-brand" asp-controller="Home" asp-action="UDashboard">JTutors</a>
        }
        else if (navSection == "admin")
        {
            <a class="navbar-brand" asp-controller="Home" asp-action="ADashboard">JTutors</a>
        }
        else
        {
            <a class="navbar-brand" asp-controller="Home" asp-action="Info">JTutors</a>
        }

        <!-- Toggler (text label so it’s visible in both themes) -->
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNav"
                aria-controls="mainNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="label">Menu</span>
        </button>

        <div class="collapse navbar-collapse" id="mainNav">
            <ul class="navbar-nav me-auto mb-2 mb-sm-0">

                @* ---------------- PUBLIC ---------------- *@
                @if (navSection == "public")
                {
                    <li class="nav-item"><a class="nav-link @Active("Info")" asp-controller="Home" asp-action="Info">Info</a></li>
                    <li class="nav-item"><a class="nav-link @Active("Login")" asp-controller="Home" asp-action="Login">Login</a></li>
                    <li class="nav-item"><a class="nav-link @Active("Login")" asp-controller="Home" asp-action="AdminLogin">Admin Login</a></li>
                    <li class="nav-item"><a class="nav-link @Active("Register")" asp-controller="Home" asp-action="Register">Register</a></li>
                }

                @* ---------------- USER ----------------- *@
                else if (navSection == "user")
                {
                    @* ---- OLD ---- *@
                    <li class="nav-item"><a class="nav-link @Active("UDashboard")" asp-controller="Home" asp-action="UDashboard">Dashboard</a></li>
                    <li class="nav-item"><a class="nav-link @Active("USessions")" asp-controller="Home" asp-action="USessions">My Sessions</a></li>
                    <li class="nav-item"><a class="nav-link @Active("UFileLibrary")" asp-controller="Home" asp-action="UFileLibrary">File Library</a></li>
                    @* ---- NEW ---- *@
                    <li class="nav-item"><a class="nav-link @Active("UPointsLedger")" asp-controller="User" asp-action="UPointsLedger">Points</a></li>
                    <li class="nav-item"><a class="nav-link @Active("UPointsLeaderboard")" asp-controller="User" asp-action="UPointsLeaderboard">Leaderboard</a></li>
                    <li class="nav-item"><a class="nav-link @Active("UProfile")" asp-controller="User" asp-action="UProfile">Profile</a></li>
                    <li class="nav-item"><a class="nav-link @Active("UBooking")" asp-controller="User" asp-action="UBooking">Book</a></li>
                    <li class="nav-item"><a class="nav-link @Active("GetUEventList")" asp-controller="Event" asp-action="GetUEventList">New Events</a></li>
                    <li class="nav-item"><a class="nav-link @Active("UEventHistory")" asp-controller="Event" asp-action="GetUEventHistory">Events History</a></li>
                
                }

                @* ---------------- ADMIN --------------- *@
                else if (navSection == "admin")
                {
                    @* ---- OLD ---- *@

                    <li class="nav-item"><a class="nav-link @Active("AEvents")" asp-controller="Home" asp-action="AEventList">Events</a></li>
                    <li class="nav-item"><a class="nav-link @Active("AAnalytics")" asp-controller="Home" asp-action="AAnalytics">Analytics</a></li>
                    <li class="nav-item"><a class="nav-link @Active("AAccount")" asp-controller="Home" asp-action="AAccount">Account</a></li>
                    @* ---- NEW ---- *@
                    <li class="nav-item"><a class="nav-link @Active("AFiles")" asp-controller="Test" asp-action="GetFileShareRows">Files</a></li>
                    <li class="nav-item"><a class="nav-link @Active("AQuotations")" asp-controller="Admin" asp-action="APricing">Quotations</a></li>
                    <li class="nav-item"><a class="nav-link @Active("ADashboard")" asp-controller="Admin" asp-action="ADashboard">Dashboard</a></li>
                    //<li class="nav-item"><a class="nav-link @Active("ASessionCalendar")" asp-controller="Admin" asp-action="ASessionCalendar">Sessions &amp; Calendar</a></li> no longer needed
                    <li class="nav-item"><a class="nav-link @Active("Agenda")" asp-controller="AdminAgenda" asp-action="Agenda">Agenda</a></li>
                    <li class="nav-item"><a class="nav-link @Active("Index")" asp-controller="AdminUserDirectory" asp-action="Index">User Directory</a></li>
                }
            </ul>

            <div class="d-flex align-items-center gap-2">
                @* Placeholder for future user/admin dropdown *@
            </div>
        </div>
    </div>
</nav>
